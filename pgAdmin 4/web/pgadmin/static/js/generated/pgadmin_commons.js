"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[946],{68938:(e,t,r)=>{var o,a,n=r(24994);r(25276);var i=n(r(2543));o=[r(98351),r(35244),r(99002),r(84726)],void 0===(a=function(e,t,r){var o=t.Browser=t.Browser||{};return o.Collection||(o.Collection=function(){},i.default.extend(o.Collection,i.default.clone(o.Node),{Init:function(){this.node_initialized||(this.node_initialized=!0,t.Browser.add_menus([{name:"refresh",node:this.type,module:this,applies:["object","context"],callback:"refresh",priority:2,label:e("Refresh")}]),t.unsupported_nodes&&-1==i.default.indexOf(t.unsupported_nodes,this.type)&&("database"==this.type&&this.allowConn||"database"!=this.type)&&(t.Browser.add_menus([{name:"show_query_tool",node:this.type,module:this,applies:["context"],callback:"show_query_tool",priority:998,label:e("Query Tool")}]),t.Browser.add_menus([{name:"search_objects",node:this.type,module:this,applies:["context"],callback:"show_search_objects",priority:997,label:e("Search Objects...")}]),t.enable_psql&&t.Browser.add_menus([{name:"show_psql_tool",node:this.type,module:this,applies:["context"],callback:"show_psql_tool",priority:998,label:e("PSQL Tool")}])))},hasId:!1,is_collection:!0,collection_node:!0,hasCollectiveStatistics:!0,canDrop:!0,canDropCascade:!0,selectParentNodeOnDelete:!1,generate_url:function(e,a){var n={properties:"obj",children:"nodes",drop:"obj"},i=this,s=o.tree.getTreeNodeHierarchy(e),l=a in n?n[a]:a;return r.generate_url(t.Browser.URL,s,l,i.node,(function(e,t){return t!=i.type}))},show_query_tool:function(){t.Tools.SQLEditor&&t.Tools.SQLEditor.showQueryTool("",t.Browser.tree.selected())},show_search_objects:function(){t.Tools.SearchObjects&&t.Tools.SearchObjects.show_search_objects("",t.Browser.tree.selected())},show_psql_tool:function(e){var t=e||{},r=o.tree,a=t.item||r.selected(),n=a?r.itemData(a):void 0;o.psql.psql_tool(n,a,!0)}})),o.Collection}.apply(t,o))||(e.exports=a)},72651:(e,t,r)=>{r(84185);var o=r(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(r(30130)),n=o(r(35244)),i=n.default.Browser=n.default.Browser||{};i.Events=new a.default;t.default=i},84726:(e,t,r)=>{var o,a;r(52675),r(89463),r(2259),r(23418),r(64346),r(34782),r(23288),r(62010),r(27495),r(38781),r(47764);var n=r(24994),i=n(r(94634));r(28706),r(50113),r(74423),r(25276),r(23792),r(59089),r(94170),r(26099),r(21699),r(62953),r(76031);var s=n(r(2543)),l=n(r(6520)),c=r(58237),d=n(r(96540)),u=n(r(84316)),p=n(r(51766)),f=n(r(6274)),h=n(r(53196)),_=r(96241);function y(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return v(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,n=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw n}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=Array(t);r<t;r++)o[r]=e[r];return o}o=[r(98351),r(35244),r(99002),r(96241),r(91849),r(72651)],void 0===(a=function(e,t,r,o){var a=t.Browser=t.Browser||{};return a.Node?a.Node:(a.Nodes=a.Nodes||{},a.Node=function(){},a.Node.extend=function(e,t){var r,o=this;if(r=function(){return o.apply(this,arguments)},s.default.extend(r,o,s.default.omit(e,"callbacks")),r.callbacks=s.default.extend({},o.callbacks,e.callbacks),null!=t&&!t)return r;var a,n,i=y(s.default.keys(r.callbacks));try{for(i.s();!(a=i.n()).done;){var l=a.value;"function"==typeof r.callbacks[n=l]&&(r.callbacks[n]=r.callbacks[n].bind(r))}}catch(e){i.e(e)}finally{i.f()}return r.Init.apply(r),this.Init.apply(r),r},s.default.extend(t.Browser.Node,{type:void 0,label:"",sqlAlterHelp:"",sqlCreateHelp:"",dialogHelp:"",epasHelp:!1,title:function(t,r){var o;return"create"==r?e("Create - %s",this.label):null!==(o=t._label)&&void 0!==o?o:""},copy:function(e){return e},hasId:!0,Init:function(){var r=this;if(!r.node_initialized){if(r.node_initialized=!0,t.Browser.add_menus([{name:"refresh",node:r.type,module:r,applies:["object","context"],callback:"refresh",priority:2,label:e("Refresh..."),enable:!0}]),r.canEdit&&t.Browser.add_menus([{name:"show_obj_properties",node:r.type,module:r,applies:["object","context"],callback:"show_obj_properties",priority:999,label:e("Properties..."),data:{action:"edit"},enable:s.default.isFunction(r.canEdit)?function(){return!!r.canEdit.apply(r,arguments)}:!!r.canEdit}]),r.canDrop&&(t.Browser.add_menus([{name:"delete_object",node:r.type,module:r,applies:["object","context"],callback:"delete_obj",priority:r.dropPriority,label:r.dropAsRemove?e("Remove %s",r.label):e("Delete"),data:{url:"drop",data_disabled:e("The selected tree node does not support this option.")},enable:s.default.isFunction(r.canDrop)?function(){return!!r.canDrop.apply(r,arguments)}:!!r.canDrop}]),r.canDropCascade&&t.Browser.add_menus([{name:"delete_object_cascade",node:r.type,module:r,applies:["object","context"],callback:"delete_obj",priority:2,label:e("Delete (Cascade)"),data:{url:"delete"},enable:s.default.isFunction(r.canDropCascade)?function(){return r.canDropCascade.apply(r,arguments)}:!!r.canDropCascade}])),-1==s.default.indexOf(t.unsupported_nodes,r.type)){var o=function(e){return!("database"!=(null==e?void 0:e._type)||null==e||!e.allowConn)||"database"!=(null==e?void 0:e._type)};t.Browser.add_menus([{name:"show_query_tool",node:r.type,module:r,applies:["context"],callback:"show_query_tool",priority:998,label:e("Query Tool"),enable:o}]),t.Browser.add_menus([{name:"search_objects",node:r.type,module:t.Tools.SearchObjects,applies:["context"],callback:"show_search_objects",priority:997,label:e("Search Objects..."),icon:"fa fa-search",enable:o}]),t.enable_psql&&t.Browser.add_menus([{name:"show_psql_tool",node:this.type,module:this,applies:["context"],callback:"show_psql_tool",priority:998,label:e("PSQL Tool")}])}r.hasScriptTypes&&s.default.isArray(r.hasScriptTypes)&&r.hasScriptTypes.length>0&&s.default.each(r.hasScriptTypes,(function(o){var a=e("%s Script",o.toUpperCase());o=o.toLowerCase(),t.Browser.add_menus([{name:"show_script_"+o,node:r.type,module:r,applies:["object","context"],callback:"show_script",priority:4,label:a,category:e("Scripts"),data:{script:o,data_disabled:e("The selected tree node does not support this option.")},enable:r.check_user_permission}])}))}},check_user_permission:function(e,t,r){if("server_group"==e._type||"server"==e._type)return!1;if("database"==e._type&&!e.allowConn)return!1;var o,n,i,l=a.tree.getTreeNodeHierarchy(t);return-1==s.default.indexOf(["create","insert","update","delete"],r.script)||(!("role"!=e.type||!l.server.user.can_create_role)||!!(null!==(o=l.server)&&void 0!==o&&o.user.is_superuser||null!==(n=l.server)&&void 0!==n&&n.user.can_create_db||null!==(i=l.schema)&&void 0!==i&&i.can_create))},hasScriptTypes:["create"],canEdit:!0,canDrop:!1,canDropCascade:!1,dropAsRemove:!1,dropPriority:2,selectParentNodeOnDelete:!1,callbacks:{show_obj_properties:function(r,n){var i=this,l=a.tree,d=(null==r?void 0:r.item)||n||l.selected(),u=d?l.itemData(d):void 0,p=this.title(u,r.action),f=a.tree.getTreeNodeHierarchy(d);if(u){var h=s.default.isArray(this.parent_type)?function(e){return-1!=s.default.indexOf(i.parent_type,e._type)}:function(e){return i.parent_type==e._type};if("create"==r.action){if(this.parent_type&&!h(u))for(;d&&l.hasParent(d);){d=l.parent(d);var _=l.itemData(d);if(h(_)){u=_;break}}if(!u||null!=this.parent_type&&!h(u))return;f=a.tree.getTreeNodeHierarchy(d);var y=s.default.uniqueId(c.BROWSER_PANELS.EDIT_PROPERTIES),v=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return a.docker.close(y,e)};this.showPropertiesDialog(y,p,{treeNodeInfo:f,item:d,nodeData:u,actionType:"create",onSave:function(e){setTimeout((function(){i.clear_cache(n)}),0);try{a.Events.trigger("pgadmin:browser:tree:add",s.default.clone(e.node),s.default.clone(f))}catch(e){console.warn(e.stack||e)}v()},onClose:v})}else if("copy"==r.action){f=a.tree.getTreeNodeHierarchy(d);var b=s.default.uniqueId(c.BROWSER_PANELS.EDIT_PROPERTIES),m=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return a.docker.close(b,e)};this.showPropertiesDialog(b,p,{treeNodeInfo:f,item:d,nodeData:u,actionType:"copy",onSave:function(e){setTimeout((function(){i.clear_cache(n)}),0);try{a.Events.trigger("pgadmin:browser:tree:add",s.default.clone(e.node),{server_group:f.server_group})}catch(e){console.warn(e.stack||e)}m()},onClose:m})}else{var w=c.BROWSER_PANELS.EDIT_PROPERTIES+u.id,g=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return a.docker.close(w,e)},D=function(e){var t=u,r=e.node,o=f;setTimeout((function(){i.clear_cache(n)}),0),a.Events.trigger("pgadmin:browser:tree:update",t,r,o,{success:function(e,t,r){a.Events.trigger("pgadmin:browser:node:updated",e,t,r),a.Events.trigger("pgadmin:browser:node:"+t._type+":updated",e,t,r)}}),g()};if(a.docker.find(w)){var T=e('Are you sure want to stop editing the properties of %s "%s"?');"edit"==r.action&&(T=e('Are you sure want to reset the current changes and re-open the panel for %s "%s"?')),t.Browser.notifier.confirm(e("Edit in progress?"),o.sprintf(T,this.label.toLowerCase(),u.label),(function(){i.showPropertiesDialog(w,p,{treeNodeInfo:f,item:d,nodeData:u,actionType:"edit",onSave:D,onClose:g},!0)}),null)}else this.showPropertiesDialog(w,p,{treeNodeInfo:f,item:d,nodeData:u,actionType:"edit",onSave:D,onClose:g})}}},delete_obj:function(r,o){var n=r||{url:"drop"},i=this,c=a.tree,d=n.item||o||c.selected(),u=d?c.itemData(d):void 0;if(u){i=a.Nodes[u._type];var p,f,h=s.default.unescape(u.label);if("delete"==n.url&&"database"===u._type)p=e('Delete database with the force option will attempt to terminate all existing connections to the <b>"%s"</b> database. Are you sure you want to proceed?',u.label),f=e("Delete FORCE %s?",i.label);else if("delete"==n.url){if(p=e('Are you sure you want to delete %s <b>"%s"</b> and all the objects that depend on it?',i.label.toLowerCase(),u.label),f=e("Delete CASCADE %s?",i.label),!(s.default.isFunction(i.canDropCascade)?i.canDropCascade(u,d):i.canDropCascade))return void t.Browser.notifier.error(e('The %s "%s" cannot be dropped.',i.label,u.label),1e4)}else if(i.dropAsRemove?(p=e('Are you sure you want to remove %s "%s"?',i.label.toLowerCase(),u.label),f=e("Remove %s?",i.label)):(p=e('Are you sure you want to delete %s <b>"%s"</b>?',i.label.toLowerCase(),u.label),f=e("Delete %s?",i.label)),!(s.default.isFunction(i.canDrop)?i.canDrop(u,d):i.canDrop))return void t.Browser.notifier.error(e('The %s "%s" cannot be dropped/removed.',i.label,u.label),1e4);t.Browser.notifier.confirm(f,p,(function(){(0,l.default)().delete(i.generate_url(d,n.url,u,!0)).then((function(e){var r=e.data;if(2!=r.success){if(0==r.success)t.Browser.notifier.alert(r.errormsg,r.info);else{var o=!0;if(i.selectParentNodeOnDelete){var n=c.parent(d);setTimeout((function(){c.select(n)}),10),o=!1}a.removeTreeNode(d,o)}return!0}t.Browser.notifier.error(r.info,null)})).catch((function(r){var o,a,n,s,l=null===(o=r.request)||void 0===o?void 0:o.responseText;if(417==(null===(a=r.request)||void 0===a?void 0:a.status)||410==(null===(n=r.request)||void 0===n?void 0:n.status)||500==(null===(s=r.request)||void 0===s?void 0:s.status))try{var c=r.response.data;l=c.info||c.errormsg}catch(e){console.warn(e.stack||e)}t.Browser.notifier.alert(e('Error dropping/removing %s: "%s"',i.label,h),l)}))}))}},show_script:function(e,r){var o,n,i=e.script,s=a.tree,l=r||s.selected(),c=l?s.itemData(l):void 0;c&&(o=a.Nodes[c._type],n="insert"==i?"insert_sql":"update"==i?"update_sql":"delete"==i?"delete_sql":"select"==i?"select_sql":"exec"==i?"exec_sql":"sql",t.Tools.SQLEditor.showQueryTool(o.generate_url(l,n,c,!0),l,i))},show_query_tool:function(r,o){var n=h.default.getState().getPreferences("sqleditor","copy_sql_to_query_tool"),i=a.tree,s=o||i.selected(),l=s?i.itemData(s):void 0;if(l)if(n.value&&!l._type.includes("coll-")){var c={script:l._type.toLowerCase(),data_disabled:e("The selected tree node does not support this option.")};a.Node.callbacks.show_script(c)}else t.Tools.SQLEditor.showQueryTool("",s)},show_psql_tool:function(e){var r=e||{},o=a.tree,n=r.item||o.selected(),i=n?o.itemData(n):void 0;t.Tools.Psql.openPsqlTool(i,n)},change_server_background:function(e,t){if(e&&t){var r=a.tree.getTreeNodeHierarchy(e).server;if(r)if(-1!==e.path.indexOf(r.id)){var o=r.icon.split(" ")[1]||null,n=r.icon.split(" ")[2]||"";if(o){var i,s="pga_server_"+r._id+"_bgcolor",l=document.createElement("style");l.setAttribute("id",s),l.setAttribute("type","text/css"),l.innerText="\n              .".concat(s," .file-label {\n                border-radius: 3px;\n                margin-bottom: 2px;\n                background: ").concat(o," !important;\n              }\n              ").concat(n?"\n              .".concat(s," span.file-name, .").concat(s," span.file-name:hover, .").concat(s," span.file-name.pseudo-active {\n                color: ").concat(n," !important;\n              }\n              "):"","\n            "),null===(i=document.querySelector('style[id="'.concat(s,'"]')))||void 0===i||i.remove(),document.head.appendChild(l),a.tree.addCssClass(e,s)}}}},added:function(e,r){-1!==a.tree.getData(e)._type.indexOf("coll-")&&setTimeout((function(){var r=t.Browser.Nodes[a.tree.getData(e).nodes[0]];r.clear_cache.apply(r)}),0),a.Events.trigger("pgadmin:browser:tree:expand-from-previous-tree-state",e),a.Node.callbacks.change_server_background(e,r)},selected:function(e,r){return t.Browser.enable_disable_menus.apply(a,[e]),a.Events.trigger("pgadmin-browser:node:selected",e,r),a.Events.trigger("pgadmin:browser:tree:update-tree-state",e),!0},removed:function(e){var t=this;setTimeout((function(){t.clear_cache(e)}),0)},refresh:function(e,t){var r=this,o=a.tree,n=t&&o.itemData(t);a.Events.trigger("pgadmin:browser:tree:refresh",t||a.tree.selected(),{success:function(){r.callbacks.selected.apply(r,[t,n,a])}})},opened:function(e){var t=a.tree,r=h.default.getState().getPreferences("browser","auto_expand_sole_children");if(null!=r&&r.value&&1==t.children(e).length){var o=t.first(e);if(o._loaded)t.open(o),t.select(o);else var n=setInterval((function(){o._loaded&&(t.open(o),t.select(o),i())}),200),i=function(){clearInterval(n)}}else if(1==t.children(e).length){var s=t.first(e);t.select(s)}a.Events.trigger("pgadmin:browser:tree:update-tree-state",e)},closed:function(e){a.Events.trigger("pgadmin:browser:tree:remove-from-tree-state",e)}},showPropertiesDialog:function(e,t,r){var o,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s={id:e,title:t,manualClose:!0,icon:"dialog-node-icon ".concat(null!==(o=(0,_.evalFunc)(this,this.node_image,r.nodeData))&&void 0!==o?o:"icon-"+this.type),content:d.default.createElement(p.default,null,d.default.createElement(u.default,(0,i.default)({panelId:e,node:this,formType:"dialog"},r)))},l=(0,f.default)(this.width||a.stdW.default+"px","width",!0),c=(0,f.default)(this.height||a.stdH.default+"px","height",!0);l=l<=a.stdW.sm?a.stdW.sm:l<=a.stdW.md?a.stdW.md:a.stdW.lg,c=c<=a.stdH.sm?a.stdH.sm:c<=a.stdH.md?a.stdH.md:a.stdH.lg,n?(r.onClose(!0),setTimeout((function(){a.docker.openDialog(s,l,c)}),10)):a.docker.openDialog(s,l,c)},_find_parent_node:function(e,t,r){if(this.parent_type)if(r=r||e.itemData(t),s.default.isString(this.parent_type)){if(this.parent_type==r._type)return t;for(;e.hasParent(t);)if(t=e.parent(t),r=e.itemData(t),this.parent_type==r._type)return t}else{if(s.default.indexOf(this.parent_type,r._type)>=0)return t;for(;e.hasParent(t);)if(t=e.parent(t),r=e.itemData(t),s.default.indexOf(this.parent_type,r._type)>=0)return t}return null},generate_url:function(e,t,o,n,i,l){var c={create:"obj",drop:"obj",edit:"obj",properties:"obj",statistics:"stats"},d=this,u=-1/0,p=s.default.isUndefined(e)||s.default.isNull(e)?i||{}:a.tree.getTreeNodeHierarchy(e),f=t in c?c[t]:t,h=n&&o._type==d.type?encodeURIComponent(o._id):"";if(d.parent_type)if(s.default.isString(d.parent_type)){var _=p[d.parent_type];_&&(u=_.priority)}else s.default.each(d.parent_type,(function(e){var t=p[e];t&&u<t.priority&&(u=t.priority)}));var y=u;l&&p[l]&&(y=p[l].priority);return r.generate_url(a.URL,p,f,d.type,(function(e){return e.priority<=y||e.priority==u}),h)},cache:function(e,t,r,a){var n=this.cached=this.cached||{},i=e,l=(null==t?void 0:t[r])&&(null==t?void 0:t[r].priority)||0;if(t&&s.default.each(s.default.sortBy(s.default.values(s.default.pickBy(t,(function(e){return e.priority<=l}))),(function(e){return e.priority})),(function(e){i=o.sprintf("%s_%s",i,encodeURI(e._id))})),s.default.isUndefined(a)){var c=n[i];return!s.default.isUndefined(c)&&c.at-Date.now()>3e5&&(c=void 0),c}return n[i]={data:a,at:Date.now(),level:r}},clear_cache:function(e){this.cached={};a.Events.trigger("pgadmin:browser:node:"+this.type+":cache_cleared",e,this)},cache_level:function(e,t){if(e){if(t&&this.type in e)return this.type;if(s.default.isArray(this.parent_type)){for(var r in this.parent_type)if(r in e)return r;return this.type}return this.parent_type}}}),t.Browser.Node)}.apply(t,o))||(e.exports=a)}}]);